<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1032.273" height="404.734" viewBox="0 0 273.122 107.086">
  <g transform="translate(-374.375 -214.818)">
    <use xlink:href="#a" transform="translate(0 -14.848)"/>
    <path fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".529" d="M538.925 252.697v.529l4.031.052v-12.194h29.45v1.087l2.093-1.375-2.093-1.375v1.134h-29.979v12.142zm33.481 29.082v1.087l2.093-1.375-2.093-1.375v1.133h-29.45V261.02h25.901v-14.007h3.55v1.087l2.092-1.374-2.093-1.376v1.134h-4.078v13.955l-29.403.052v.53h3.502v46.008h54.87v1.133l2.093-1.375-2.092-1.374v1.087h-54.342v-24.721zm-90.24 2.333v.53l4.144.052v-27.361h8.216v1.087l2.092-1.375-2.092-1.375v1.134h-8.745v27.308zm-12.509-37.244v-.53l20.27-.051v5.925h4.599v-1.087l2.092 1.375-2.092 1.375v-1.133h-5.129v-5.874z" paint-order="markers stroke fill"/>
    <path fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".529" d="M375.466 311.428v.529l114.46.052v-50.1h4.6v1.087l2.092-1.375-2.092-1.375v1.133h-5.129v50.049z" paint-order="markers stroke fill"/>
    <text xml:space="preserve" x="409.485" y="219.636" fill="#fff" stroke="#000" stroke-linecap="square" stroke-opacity=".798" stroke-width="1.058" font-family="Monospace" font-size="5.644" font-weight="700" paint-order="markers stroke fill" style="Monospace, Bold&quot;;text-align:start;"><tspan x="409.485" y="219.636" style="Monospace, Bold&quot;;text-align:start;">Mask Decoder</tspan></text>
    <text xml:space="preserve" x="381.84" y="316.244" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:start;"><tspan x="381.84" y="316.244" style="text-align:start;">B<tspan style="text-align:center" text-anchor="middle">x</tspan>FxHxW</tspan></text>
    <text xml:space="preserve" x="390.885" y="303.601" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="390.885" y="303.601" style="text-align:center;">BxNxF</tspan></text>
    <text xml:space="preserve" x="390.589" y="244.941" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="390.589" y="244.941" style="text-align:center;">BxFxHxW</tspan></text>
    <text xml:space="preserve" x="390.76" y="257.038" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="390.76" y="257.038" style="text-align:center;">Bx4Hx4W</tspan></text>
    <text xml:space="preserve" x="390.958" y="238.391" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="390.958" y="238.391" style="text-align:center;">image tokens</tspan></text>
    <text xml:space="preserve" x="634.566" y="279.884" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="634.566" y="279.884" style="text-align:center;">IoUs</tspan></text>
    <text xml:space="preserve" x="634.661" y="241.677" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="634.661" y="241.677" style="text-align:center;">masks</tspan></text>
    <text xml:space="preserve" x="570.602" y="262.12" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:start;"><tspan x="570.602" y="262.12" style="text-align:start;">(cls mask tokens)</tspan></text>
    <text xml:space="preserve" x="557.497" y="293.656" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:start;" text-anchor="middle"><tspan x="557.497" y="293.656" style="text-align:start;">(IoU token)</tspan></text>
    <text xml:space="preserve" x="570.433" y="305.212" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:start;" text-anchor="middle"><tspan x="570.433" y="305.212" style="text-align:start;">enc. cls tokens</tspan></text>
    <text xml:space="preserve" x="570.35" y="311.152" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:start;" text-anchor="middle"><tspan x="570.35" y="311.152" style="text-align:start;">(optional output)</tspan></text>
    <text xml:space="preserve" x="571.838" y="238.456" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:end;" text-anchor="end"><tspan x="571.838" y="238.456" style="text-align:end;">(image tokens)</tspan></text>
    <text xml:space="preserve" x="390.887" y="310.223" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="390.887" y="310.223" style="text-align:center;">enc. grid xy</tspan></text>
    <g stroke-linecap="square" transform="translate(3.254 13.406)">
      <path id="b" fill="#fc0" stroke="#000" stroke-dasharray="none" stroke-width=".529" d="M426.011 225.496h38.894v15.346h-38.894z" paint-order="stroke fill markers"/>
      <text xml:space="preserve" x="445.56" y="231.896" stroke-opacity=".798" stroke-width=".265" font-family="Monospace" font-size="5.644" font-weight="700" paint-order="markers stroke fill" style="Monospace, Bold&quot;;text-align:center" text-anchor="middle"><tspan x="445.56" y="231.896" style="Monospace, Bold&quot;;">Mask Hint</tspan><tspan x="445.56" y="238.952" style="Monospace, Bold&quot;;">Encoder</tspan></text>
    </g>
    <g transform="translate(-17.935 -.664)">
      <use xlink:href="#b" id="c" x="0" y="0" transform="translate(90.145 24.576)"/>
      <text xml:space="preserve" x="535.78" y="256.272" stroke-linecap="square" stroke-opacity=".798" stroke-width=".265" font-family="Monospace" font-size="5.644" font-weight="700" paint-order="markers stroke fill" style="Monospace, Bold&quot;;text-align:center" text-anchor="middle"><tspan x="535.78" y="256.272" style="Monospace, Bold&quot;;">Cross</tspan><tspan x="535.78" y="263.327" style="Monospace, Bold&quot;;">Attention</tspan></text>
    </g>
    <text xml:space="preserve" x="390.945" y="297.066" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="390.945" y="297.066" style="text-align:center;">prompt tokens</tspan></text>
    <text xml:space="preserve" x="391.027" y="250.913" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="391.027" y="250.913" style="text-align:center;">mask hint</tspan></text>
    <path fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".529" d="m424.838 253.884 2.093-1.375-2.093-1.375v1.088h-49.372v.529h49.372zm220.085 29.036 2.092-1.374-2.092-1.375v1.087h-28.16v.53h28.16zm0-38.271 2.092-1.375-2.092-1.375v1.087h-28.16v.53h28.16z" paint-order="markers stroke fill"/>
    <g stroke-linecap="square" stroke-width=".529" paint-order="markers stroke fill" transform="translate(51.085 -46.396)">
      <circle cx="421.857" cy="330.75" r="7.673" fill="#0a8" stroke="#000"/>
      <text xml:space="preserve" x="421.669" y="332.328" fill="#1a1a1a" font-family="Monospace" font-size="4.233" font-weight="400" style="text-align:center" text-anchor="middle"><tspan x="421.669" y="332.328" style="">stack</tspan></text>
    </g>
    <text xml:space="preserve" x="434.949" y="271.095" fill="#1a1a1a" stroke-linecap="square" stroke-width=".529" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center" text-anchor="middle"><tspan x="434.949" y="271.095" style="">cls IoU token</tspan></text>
    <path id="a" fill="#0a8" fill-opacity="1" stroke="#000" stroke-dasharray="none" stroke-linecap="square" stroke-width=".529" d="M414.06 281.311h41.804v6.085H414.06z" paint-order="stroke fill markers"/>
    <text xml:space="preserve" x="434.971" y="285.943" fill="#1a1a1a" stroke-linecap="square" stroke-width=".529" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center" text-anchor="middle"><tspan x="434.971" y="285.943" style="">cls mask tokens</tspan></text>
    <g transform="translate(-27.558 5.671)">
      <use xlink:href="#c" id="d" x="0" y="0" transform="translate(87.684 -20.142)"/>
      <text xml:space="preserve" x="623.238" y="236.179" stroke-linecap="square" stroke-opacity=".798" stroke-width=".265" font-family="Monospace" font-size="5.644" font-weight="700" paint-order="markers stroke fill" style="Monospace, Bold&quot;;text-align:center" text-anchor="middle"><tspan x="623.238" y="236.179" style="Monospace, Bold&quot;;">Mask</tspan><tspan x="623.238" y="243.235" style="Monospace, Bold&quot;;">Generator</tspan></text>
    </g>
    <g transform="translate(-49.874 5.682)">
      <use xlink:href="#d" transform="translate(22.316 38.26)"/>
      <text xml:space="preserve" x="645.602" y="274.393" stroke-linecap="square" stroke-opacity=".798" stroke-width=".265" font-family="Monospace" font-size="5.644" font-weight="700" paint-order="markers stroke fill" style="Monospace, Bold&quot;;text-align:center" text-anchor="middle"><tspan x="645.602" y="274.393" style="Monospace, Bold&quot;;">IoU</tspan><tspan x="645.602" y="281.449" style="Monospace, Bold&quot;;">MLP</tspan></text>
    </g>
    <path fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".529" d="m460.843 282.979 2.092 1.375-2.092 1.374v-1.087h-3.608v-.529h3.608z" paint-order="markers stroke fill"/>
    <g stroke-linecap="square" stroke-width=".529" paint-order="markers stroke fill" transform="translate(100.485 -208.515)">
      <circle cx="457.011" cy="490.006" r="7.673" fill="#0a8" stroke="#000"/>
      <text xml:space="preserve" x="456.906" y="488.938" fill="#1a1a1a" font-family="Monospace" font-size="4.233" font-weight="400" style="text-align:center" text-anchor="middle"><tspan x="456.906" y="488.938" style="">index</tspan><tspan x="456.906" y="494.23" style="">0</tspan></text>
    </g>
    <g stroke-linecap="square" stroke-width=".529" paint-order="markers stroke fill" transform="translate(109.665 -254.556)">
      <circle cx="447.832" cy="515.335" r="7.673" fill="#0a8" stroke="#000"/>
      <text xml:space="preserve" x="447.726" y="514.267" fill="#1a1a1a" font-family="Monospace" font-size="4.233" font-weight="400" style="text-align:center" text-anchor="middle"><tspan x="447.726" y="514.267" style="">index</tspan><tspan x="447.726" y="519.559" style="">1-4</tspan></text>
    </g>
    <path fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".529" d="M472.923 273.23h1.133l-1.375 2.093-1.374-2.093h1.087v-3.297H457.16v-.529l15.763-.052zm-.088 22.261h1.133l-1.375-2.092-1.375 2.092h1.088v3.297h-96.84v.53l97.369.051z" paint-order="markers stroke fill"/>
    <text xml:space="preserve" x="634.494" y="286.661" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="634.494" y="286.661" style="text-align:center;">Bx4</tspan></text>
    <text xml:space="preserve" x="634.393" y="248.318" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:center;" text-anchor="middle"><tspan x="634.393" y="248.318" style="text-align:center;">Bx4x4Hx4W</tspan></text>
    <text xml:space="preserve" x="600.291" y="308.125" fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".794" font-family="Monospace" font-size="4.233" font-weight="400" paint-order="markers stroke fill" style="text-align:start;"><tspan x="600.291" y="308.125" style="text-align:start;">Bx5xF</tspan></text>
    <path fill="#fff" stroke="#000" stroke-linecap="square" stroke-width=".529" d="m424.838 241.787 2.093-1.375-2.093-1.375v1.088h-49.372v.529h49.372z" paint-order="markers stroke fill"/>
    <path fill="none" stroke="#d40055" stroke-linecap="square" stroke-width="1.058" d="M409.986 221.604h211.032v99.771H409.986z" paint-order="stroke fill markers"/>
  </g>
</svg>
